<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>root&#39;s Blog</title>
  <meta name="viewport" content="width=device-width">
  <meta name="description" content="Why do you ask my name? It is beyond understanding.">
<meta property="og:type" content="website">
<meta property="og:title" content="root's Blog">
<meta property="og:url" content="http://blog.ohai.ca/page/2/index.html">
<meta property="og:site_name" content="root's Blog">
<meta property="og:description" content="Why do you ask my name? It is beyond understanding.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="root's Blog">
<meta name="twitter:description" content="Why do you ask my name? It is beyond understanding.">
  
    <link rel="alternative" href="/atom.xml" title="root&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="../../css/style.css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]--><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div class="mobile-nav-panel">
	<i class="icon-reorder icon-large"></i>
</div>
<header id="header">
	<h1 class="blog-title">
		<a href="/">root&#39;s Blog</a>
	</h1>
	<nav class="nav">
		<ul>
			<li><a href="/">Home</a></li><li><a href="/archives">Archives</a></li>
			<li><a id="nav-search-btn" class="nav-icon" title="Search"></a></li>
			<li><a href="/atom.xml" id="nav-rss-link" class="nav-icon" title="RSS Feed"></a></li>
		</ul>
	</nav>
	<div id="search-form-wrap">
		<form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://blog.ohai.ca"></form>
	</div>
</header>
    <div id="main">
      
  
    <article id="post-How-to-talk-to-people" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2019/How-to-talk-to-people/" class="article-date">
  <time datetime="2019-04-14T01:19:07.000Z" itemprop="datePublished">2019-04-13</time>
</a>
		</span>
		<span class="meta-elements author">root</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2019/How-to-talk-to-people/">How to Talk to People</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<h1 id="ÁÇ∏-zha"><a href="#ÁÇ∏-zha" class="headerlink" title="ÁÇ∏ [zh√°]"></a><a href="https://baike.baidu.com/item/%E7%82%B8/4687479#3" target="_blank" rel="external">ÁÇ∏</a> [zh√°]</h1><blockquote>
<p> I make my living talking to people. Nobel Prize winners, truck drivers, billionaires, kindergarten teachers, heads of state, plumbers‚Ä¶ I talk to people that I like; I talk to people that I don‚Äôt like; I talked to some people that I disagree with deeply on a personal level, but I still have a great conversation with them.</p>
</blockquote>
<h2 id="Don‚Äôt-multitask"><a href="#Don‚Äôt-multitask" class="headerlink" title="Don‚Äôt multitask."></a>Don‚Äôt multitask.</h2><p>Be in <em>that</em> moment. Don‚Äôt think about anything else. <a href="https://www.youtube.com/watch?v=vRK0eSCYYFk" target="_blank" rel="external">Remove your conversational filters</a> and talk, and <strong>share</strong> (aka ‚Äúgive and take‚Äù). If you think about your filters, you stop paying attention.</p>
<blockquote>
<p>There is no reason to learn how to show you‚Äôre paying attention if you are in fact paying attention.</p>
</blockquote>
<h3 id="After-‚Äúthat-moment‚Äù"><a href="#After-‚Äúthat-moment‚Äù" class="headerlink" title="After ‚Äúthat moment‚Äù"></a>After ‚Äúthat moment‚Äù</h3><ul>
<li>Think about what happened and what was discussed.</li>
<li>Assess your body language that you used at the time.</li>
<li>Assess your body language that the other people used at the time.</li>
</ul>
<h2 id="Don‚Äôt-pontificate"><a href="#Don‚Äôt-pontificate" class="headerlink" title="Don‚Äôt pontificate."></a>Don‚Äôt pontificate.</h2><p><a href="https://www.wordnik.com/words/pontificate" target="_blank" rel="external"><em>v. To express opinions or judgments in a dogmatic way.</em></a></p>
<p>Set your opinions aside. Enter every conversation assuming you have something to learn.</p>
<p>This also means: <strong>be a listener</strong>.</p>
<h2 id="Use-open-ended-questions"><a href="#Use-open-ended-questions" class="headerlink" title="Use open-ended questions."></a>Use open-ended questions.</h2><p>Don‚Äôt ask questions that can be answered with ‚Äúyes‚Äù or ‚Äúno‚Äù. If you don‚Äôt know how to do that, ask questions that start with ‚Äúwho‚Äù, ‚Äúwhat‚Äù, ‚Äúwhen‚Äù, ‚Äúwhere‚Äù, or ‚Äúwhy‚Äù, all of which guarantee an answer that is not ‚Äúyes‚Äù or ‚Äúno‚Äù.</p>
<h2 id="Go-with-the-flow"><a href="#Go-with-the-flow" class="headerlink" title="Go with the flow."></a>Go with the flow.</h2><p>Conversation ideas can come and go. You might think of a clever thing to ask two minutes before the person stopped talking, at which point it is no longer appropriate to ask it. Let them come and let them go.</p>
<h2 id="If-you-don‚Äôt-know-say-that-you-don‚Äôt-know"><a href="#If-you-don‚Äôt-know-say-that-you-don‚Äôt-know" class="headerlink" title="If you don‚Äôt know, say that you don‚Äôt know."></a>If you don‚Äôt know, say that you don‚Äôt know.</h2><p>Don‚Äôt claim to be an expert on anything.</p>
<h2 id="Don‚Äôt-equate-your-experience-with-theirs"><a href="#Don‚Äôt-equate-your-experience-with-theirs" class="headerlink" title="Don‚Äôt equate your experience with theirs."></a>Don‚Äôt equate your experience with theirs.</h2><p>It is never the same. All experiences are individual. Don‚Äôt take the moment to share your experience.</p>
<p>But remember <em>don‚Äôt be afraid to be vulnerable</em>. Everyone is flawed in some way. Don‚Äôt be afraid to show it.</p>
<h2 id="Try-not-to-repeat-yourself"><a href="#Try-not-to-repeat-yourself" class="headerlink" title="Try not to repeat yourself."></a>Try not to repeat yourself.</h2><p>It‚Äôs condescending.</p>
<h2 id="Stay-out-of-the-weeds"><a href="#Stay-out-of-the-weeds" class="headerlink" title="Stay out of the weeds."></a>Stay out of the weeds.</h2><p>No one cares about the details (weeds). Leave them out.</p>
<h2 id="LISTEN"><a href="#LISTEN" class="headerlink" title="LISTEN."></a>LISTEN.</h2><blockquote>
<p>If your mouth is open, you‚Äôre not learning. - Claims to be said by a buddha</p>
</blockquote>
<p>You have to listen with the intent to understand, not just the intent to answer.</p>
<h2 id="Be-brief"><a href="#Be-brief" class="headerlink" title="Be brief."></a>Be brief.</h2><p><a href="https://www.youtube.com/watch?v=R1vskiVDwl4" target="_blank" rel="external"><strong>Be interested in other people.</strong></a> Everyone has some hidden, amazing things about them. Keep your mouth shut for as long as possible.</p>
<h2 id="If-all-else-fails"><a href="#If-all-else-fails" class="headerlink" title="If all else fails"></a>If all else fails</h2><p>Stick to the weather (excluding ‚Äúglobal warming is a hoax‚Äù) and your health (excluding topics about vaccines).</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/Lifestyle/">Lifestyle</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-Writing-a-flake8-plugin" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2019/Writing-a-flake8-plugin/" class="article-date">
  <time datetime="2019-04-11T15:45:33.000Z" itemprop="datePublished">2019-04-11</time>
</a>
		</span>
		<span class="meta-elements author">root</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2019/Writing-a-flake8-plugin/">Writing a Flake8 Plugin</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>There appears to be no good way to run a flake8 plugin that is not its own package. For example, if you have a project and you want to include a custom flake8 inside it, you will have to <em>install your project</em> to <a href="https://flake8.pycqa.org/en/latest/plugin-development/registering-plugins.html" target="_blank" rel="external">register</a> it:</p>
<pre><code># Me literally installing myself so flake8 can find it 
from setuptools import setup


setup(
    name=&apos;my_project&apos;,
    author=&apos;Me&apos;,
    license=&apos;Proprietary&apos;,
    classifiers=[
        &apos;License :: Other/Proprietary License&apos;,
    ],
    packages=[
        &apos;my_static_checker&apos;,
    ],
    entry_points={
        &apos;flake8.extension&apos;: [
            &apos;R2 = my_static_checker.main:Checker&apos;,
        ],
    },
)
</code></pre><p>As for what <code>Checker</code> checking, it is largely up to you, as long as the class contains a <code>run</code> method that yields four things:</p>
<pre><code>import ast

class Checker:
    name = &apos;my_static_checker&apos;
    version = &apos;0.1&apos;

    def __init__(self, tree, filename):
        self.tree = tree
        self.filename = filename

    def run(self):
        # Use whatever tool you like to find these, but ast is imported
        errors = (line, column, message)
        for line, column, message in errors:
            yield line, column, message, type(self)
</code></pre>
    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/Python/">Python</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-Commenting" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2019/Commenting/" class="article-date">
  <time datetime="2019-04-09T20:51:57.000Z" itemprop="datePublished">2019-04-09</time>
</a>
		</span>
		<span class="meta-elements author">root</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2019/Commenting/">Commenting</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>Excerpts. Interpretation of the <a href="http://antirez.com/news/124" target="_blank" rel="external">source</a>. If you want to see examples for any of these, go check out the source.</p>
<h2 id="Why-write-comments"><a href="#Why-write-comments" class="headerlink" title="Why write comments"></a>Why write comments</h2><p>Comments are rubber duck debugging on steroids, except you are not talking with a rubber duck, but with the future reader of the code. You explain why what you are doing <em>is acceptable</em>, honorable, or good enough. And if it is not, you make your homework, and come up with something more decent.</p>
<p>Comments also help others understand you and your work.</p>
<h2 id="Do-write-Function-comments-aka-docstrings"><a href="#Do-write-Function-comments-aka-docstrings" class="headerlink" title="Do write: Function comments aka docstrings"></a>Do write: Function comments aka docstrings</h2><p>Function comments are actually a form of in-line API documentation.</p>
<ul>
<li>The reader should be able to use a function without understanding the implementation, i.e. treating the function as a black box.</li>
<li>Putting docstrings for functions directly where they are defined helps the reader focus on the code, instead of context switching between code and documentation.</li>
</ul>
<p>Notes:</p>
<ul>
<li>You need to update the docstring whenever you change the code. Yes you need to check this when you change the function, but the benefits outweigh the ‚Äúthe code is the only source of truth‚Äù argument.</li>
</ul>
<h2 id="Do-write-Design-comments-aka-module-docstrings"><a href="#Do-write-Design-comments-aka-module-docstrings" class="headerlink" title="Do write: Design comments aka module docstrings"></a>Do write: Design comments aka module docstrings</h2><p>The design comment states how and why a given piece of code uses certain algorithms, techniques, tricks, and implementation. It is an higher level overview of what you‚Äôll see implemented in the code. With such background, reading the code will be simpler.</p>
<ul>
<li>Why is this trivial-looking module not <em>actually</em> trivial?</li>
<li>Why is a particular algorithm design chosen instead of something else? (explains why the author is not just being lazy.)</li>
</ul>
<p>Notes:</p>
<ul>
<li>Apart from function and design comments, other types of comments here don‚Äôt necessarily come in the form of a docstring.</li>
</ul>
<h2 id="Do-write-Why-comments"><a href="#Do-write-Why-comments" class="headerlink" title="Do write: Why comments"></a>Do write: Why comments</h2><p>Why comments explain the reason why the code is doing something, even if <em>what</em> the code is doing is crystal clear.</p>
<ul>
<li>Why is this function clearing the user cookie?</li>
<li>Why is this function clearing the user cookie after a certain function call, and not before?</li>
<li>Why is this thing written this way, and not a more obvious way?</li>
<li>Why shouldn‚Äôt I change this line here? (hint: it‚Äôs harmful for reasons that are not obvious.)</li>
</ul>
<h2 id="Do-write-Teacher-comments"><a href="#Do-write-Teacher-comments" class="headerlink" title="Do write: Teacher comments"></a>Do write: Teacher comments</h2><p>Teacher comments teach the reader the domain (for example math, computer graphics, networking, statistics, complex data structures) in which the code is operating, that may be one outside of the reader skills set, or is simply too full of details to recall all them from memory.</p>
<ul>
<li>What is the haversine formula?</li>
<li>What is this data structure that the code is using?</li>
<li>Corner cases that this implementation is, and is not, designed to take care of.</li>
</ul>
<p>Notes:</p>
<ul>
<li>Teacher comments do not relate to the code.</li>
</ul>
<h2 id="Do-write-Checklist-comments"><a href="#Do-write-Checklist-comments" class="headerlink" title="Do write: Checklist comments"></a>Do write: Checklist comments</h2><p>Checklist comments tell you if you do one thing, you need to do other specific things as well.</p>
<ul>
<li>It tells you a set of actions to do when something is modified.</li>
<li>It warns you about the way certain changes should be operated.</li>
</ul>
<p>Notes:</p>
<ul>
<li>Unlike ‚Äúwhy comments‚Äù, the checklist comment used in the same case is more biased towards telling you what rules to follow if you want to modify it, without breaking the code behavior.</li>
<li>Checklist comments are very common inside the Linux kernel, where the order of certain operations is extremely important.</li>
</ul>
<h2 id="Do-write-Guide-comments"><a href="#Do-write-Guide-comments" class="headerlink" title="Do write: Guide comments"></a>Do write: Guide comments</h2><p>Guide comments‚Äô sole reason to exist is to lower the cognitive load of the programmer reading some code. <strong>They are (‚Ä¶) what most people believe to be completely useless comments.</strong></p>
<ul>
<li>Guide comments are step-by-step, line-by-line comments that make a piece of code easier to read.</li>
<li>They‚Äôll acknowledge you about the fact you are understanding it right.</li>
</ul>
<p>Notes:</p>
<ul>
<li>If the code isn‚Äôt actually hard to read, these comments become ‚ÄúTrivial comments‚Äù (see below). If you want to leave guide comments, make sure the comment is necessary.</li>
</ul>
<h2 id="Do-not-write-Trivial-comments"><a href="#Do-not-write-Trivial-comments" class="headerlink" title="Do not write: Trivial comments"></a>Do not write: Trivial comments</h2><ul>
<li>Trivial comments tell you, say, it is incrementing a variable, on the line that increments a variable.</li>
<li>Trivial comments state ‚Äú<em>what</em> the code is doing, and not why.‚Äù</li>
</ul>
<h2 id="Do-not-write-Debt-comments"><a href="#Do-not-write-Debt-comments" class="headerlink" title="Do not write: Debt comments"></a>Do not write: Debt comments</h2><p>FIXME, TODO, XXX, ‚ÄúThis is a hack‚Äù, are all forms of debt comments.</p>
<p>The issue with debt comments are these FIXMEs might require a different kind of fix in the future, which may mislead a future author into doing the wrong thing. </p>
<h2 id="Do-not-write-Backup-comments"><a href="#Do-not-write-Backup-comments" class="headerlink" title="Do not write: Backup comments"></a>Do not write: Backup comments</h2><p>Backup comments are commented-out code.</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/Software-Development/">Software Development</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-Why-is-gpg-so-hard" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2019/Why-is-gpg-so-hard/" class="article-date">
  <time datetime="2019-04-02T14:47:33.000Z" itemprop="datePublished">2019-04-02</time>
</a>
		</span>
		<span class="meta-elements author">root</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2019/Why-is-gpg-so-hard/">Why Is Gpg So Hard?</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>Can‚Äôt we learn just the basics first?</p>
<h2 id="Managing-keys"><a href="#Managing-keys" class="headerlink" title="Managing keys"></a>Managing keys</h2><h3 id="Your-own-keys"><a href="#Your-own-keys" class="headerlink" title="Your own keys"></a>Your own keys</h3><ul>
<li><strong>List the keys you have</strong>: <code>gpg --list-secret-keys</code></li>
<li><strong>Create a new key</strong>: <code>gpg --gen-key</code></li>
<li><strong>Renew an existing key</strong>: <a href="https://www.g-loaded.eu/2010/11/01/change-expiration-date-gpg-key/" target="_blank" rel="external"><code>gpg --edit-key &lt;key-uid&gt;</code>, then type in <code>expire</code></a>, which also allows renewal.</li>
<li><strong>Set the default key</strong>: <a href="https://unix.stackexchange.com/a/339083" target="_blank" rel="external">edit <code>default-key &lt;key-uid&gt;</code> in <code>~/.gnupg/gpg.conf</code></a></li>
<li><strong>Publish your key to the key server</strong>: <code>gpg --keyserver pgp.mit.edu --send-keys &lt;key-uid&gt;</code></li>
<li>Revoke a subkey: <code>gpg --edit-key admin@example.com</code>, then type <code>revkey</code> on a subkey. Finally, publish your key to the key server (see above). In general you try not to use or revoke your master keys because of this.</li>
</ul>
<h3 id="Other-people‚Äôs-keys"><a href="#Other-people‚Äôs-keys" class="headerlink" title="Other people‚Äôs keys"></a>Other people‚Äôs keys</h3><ul>
<li><strong>List all keys</strong>: <code>gpg --list-keys</code></li>
<li><strong>Search for someone‚Äôs key</strong>: <code>gpg --search-keys admin@example.com</code>, which also prompts if you want to import it.</li>
<li><strong>Import a key from the key server</strong>: <code>gpg --recv-keys &lt;key-uid&gt;</code></li>
<li><strong>Import a key from a file</strong>: <a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/4/html/Step_by_Step_Guide/s1-gnupg-import.html" target="_blank" rel="external"><code>gpg --import key.asc</code></a>, with ‚Äú.asc‚Äù being <a href="https://superuser.com/questions/814355/what-file-extensions-should-be-used-on-gpg-generated-output" target="_blank" rel="external">ASCII-armoured</a></li>
<li><strong>Trust a key</strong>: <code>gpg --edit-key admin@example.com</code>, and then type <code>trust</code>.</li>
</ul>
<h2 id="Using-keys"><a href="#Using-keys" class="headerlink" title="Using keys"></a>Using keys</h2><h3 id="Encryption"><a href="#Encryption" class="headerlink" title="Encryption"></a>Encryption</h3><ul>
<li><strong>Create a master encryption key</strong>: <code>gpg --gen-key</code>, then select <code>(1) RSA and RSA (default)</code>, which both encrypts and signs.</li>
<li><strong>Create a encryption subkey</strong>: <code>gpg --edit-key admin@example.com</code>, <a href="https://wiki.debian.org/Subkeys" target="_blank" rel="external">then type <code>addkey</code></a>. You will be given one or more <code>(encrypt only)</code> options.</li>
<li><strong>Encrypt some text</strong>: <code>echo &#39;text&#39; | gpg -ear admin@example.com</code></li>
<li><strong>Decrypt some text</strong>: <code>gpg --decrypt</code>, paste in the armoured text you got from the command above, then press Ctrl+D.</li>
<li><strong>Encrypt a file with a recipient</strong>: <code>gpg -er lpppppl@gmail.com file</code> (makes <code>file.gpg</code>)</li>
<li><strong>Encrypt a file with a passphrase</strong>: <code>gpg -c file</code> (makes <code>file.gpg</code>)</li>
<li><strong>Decrypt a file</strong>: <code>gpg -d file.gpg &gt; file</code></li>
</ul>
<h3 id="Signing"><a href="#Signing" class="headerlink" title="Signing"></a>Signing</h3><p><a href="https://www.gnupg.org/gph/en/manual/x135.html" target="_blank" rel="external">Signing also timestamps a document</a>, so not only do you know who signed it, but also <em>when</em> they did, and if they resign something later, it is going to show.</p>
<ul>
<li><strong>Create a master signing key</strong>: <code>gpg --gen-key</code>, then select either <code>(1) RSA and RSA (default)</code>, which both encrypts and signs, or <code>(3) DSA (sign only)</code> or <code>(4) RSA (sign only)</code>, which only sign.</li>
<li><strong>Create a signing subkey</strong>: <code>gpg --edit-key admin@example.com</code>, <a href="https://wiki.debian.org/Subkeys" target="_blank" rel="external">then type <code>addkey</code></a>. You will be given one or more <code>(sign only)</code> options.</li>
<li><strong>Sign some text</strong>: <a href="https://guides.library.illinois.edu/data_encryption/gpgcheatsheet" target="_blank" rel="external"><code>echo &quot;Text&quot; | gpg -s &gt; OutFile</code></a> </li>
<li><strong>Sign a file</strong>: <code>gpg --armor --detach-sig --sign FileName</code> or <code>gpg -abs FileName</code> (without <code>--detach-sig</code>, the output includes the file, which can be huge.)</li>
<li><strong>Verify signature on some text</strong>: dunno üòÇ</li>
<li><strong>Verify signature on a file</strong>: <code>gpg --verify FileName.asc FileName</code></li>
</ul>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/Linux/">Linux</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
    <article id="post-A-big-request" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2019/A-big-request/" class="article-date">
  <time datetime="2019-03-20T14:41:21.000Z" itemprop="datePublished">2019-03-20</time>
</a>
		</span>
		<span class="meta-elements author">root</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 itemprop="name" class="entry-title">
      <a class="article-title" href="/2019/A-big-request/">A Big Request</a>
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>I wanted to make a reporting resource on a web server. (Some people call me a web developer, but I‚Äôm not the best.) Naturally, since reporting should not have any side effects, the <code>GET</code> method ought to do the job.</p>
<p><a href="https://tools.ietf.org/html/rfc7231#section-4.3.1" target="_blank" rel="external">The <code>GET</code> method</a> is said to serve this purpose:</p>
<blockquote>
<p>The GET method requests transfer of a current selected representation<br>for the target resource.  <strong>GET is the primary mechanism of information<br>retrieval</strong> and the focus of almost all performance optimizations.<br>‚Ä¶</p>
</blockquote>
<p>What did they mean by <em>primary</em> mechanism of information retrieval? Is there a secondary mechanism of information retrieval? Looking at <a href="https://tools.ietf.org/html/rfc7231#section-6.4.4" target="_blank" rel="external">the rest of RFC7231</a>, they may be referring exclusively to <code>HEAD</code>:</p>
<blockquote>
<p>A user agent can perform a retrieval request targeting that URI<br>(a GET <strong>or HEAD</strong> request if using HTTP)</p>
</blockquote>
<p>So, if you are an HTTP client, you can only use <code>GET</code> or <code>HEAD</code> to retrieve information from a web server. <em>Got it.</em></p>
<p>But what if your GET request has <a href="https://stackoverflow.com/questions/2891574/how-do-i-resolve-a-http-414-request-uri-too-long-error" target="_blank" rel="external">too many parameters</a> (HTTP 414)?</p>
<h2 id="A-big-request"><a href="#A-big-request" class="headerlink" title="A big request"></a>A big request</h2><p>I am making <code>GET</code> requests that have too many query parameters. I can see a few potential solutions:</p>
<ul>
<li>Send fewer query parameters,</li>
<li>Set up the web server to take more query parameters,</li>
<li>Change the <code>GET</code> to some other verb, or</li>
<li>Something else.</li>
</ul>
<h2 id="Solution-1-send-fewer-query-parameters"><a href="#Solution-1-send-fewer-query-parameters" class="headerlink" title="Solution 1: send fewer query parameters"></a>Solution 1: send fewer query parameters</h2><p>The first solution is often the most straightforward: if you want to get around <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/414" target="_blank" rel="external">‚ÄúURI Too Long‚Äù</a>, then send fewer query parameters. How hard is that?</p>
<p>Well, it is quite hard, as it turns out. Some APIs really to accept requests like <a href="https://stackoverflow.com/questions/31046675/php-restful-api-http-get-request-with-long-uri?noredirect=1&amp;lq=1#comment50233989_31048436" target="_blank" rel="external"><code>site/reports/{filter1:&lt;filter1&gt;, filter2:&lt;filter2&gt;, ...}</code></a>, and there is no way to shorten these filters.</p>
<p><strong>Conclusion: not feasible</strong></p>
<h2 id="Solution-2-set-up-the-web-server-to-take-more-query-parameters"><a href="#Solution-2-set-up-the-web-server-to-take-more-query-parameters" class="headerlink" title="Solution 2: set up the web server to take more query parameters"></a>Solution 2: set up the web server to take more query parameters</h2><p><a href="https://stackoverflow.com/a/2891598/1558430" target="_blank" rel="external">You can configure Apache to take a longer URI</a> by modifying the <a href="http://httpd.apache.org/docs/2.2/mod/core.html#limitrequestline" target="_blank" rel="external"><code>LimitRequestLine</code></a> value, from 8kB to something else, but it also makes the service susceptible to DoS attacks. Also, just because your API accepts longer query strings, it doesn‚Äôt mean your client‚Äôs browser can send them. <a href="https://stackoverflow.com/a/2659995/1558430" target="_blank" rel="external">‚ÄúThe limit is in MSIE and Safari about 2KB, in Opera about 4KB and in Firefox about 8KB. We may thus assume that 8KB is the maximum possible length and that 2KB is a more affordable length to rely on at the server side and that 255 bytes is the safest length to assume that the entire URL will come in. If the limit is exceeded in either the browser or the server, most will just truncate the characters outside the limit without any warning.‚Äù</a></p>
<p>And we know <a href="https://www.theverge.com/2018/1/4/16805216/google-chrome-only-sites-internet-explorer-6-web-standards" target="_blank" rel="external">we can‚Äôt force the client to use a particular browser</a>.</p>
<p><strong>Conclusion: not feasible</strong></p>
<h2 id="Solution-3-change-the-GET-to-some-other-verb"><a href="#Solution-3-change-the-GET-to-some-other-verb" class="headerlink" title="Solution 3: change the GET to some other verb"></a>Solution 3: change the <code>GET</code> to some other verb</h2><p>Recall that RFC7231 says only <code>GET</code> and <code>HEAD</code> can be used to retrieve information from the server.</p>
<p>So what if we change the <code>GET</code> request to a <code>HEAD</code>?</p>
<p><a href="https://tools.ietf.org/html/rfc7231#section-4.3.2" target="_blank" rel="external">The HEAD method is identical to GET</a>, except a <code>HEAD</code> request can‚Äôt even have a response body:</p>
<blockquote>
<p>The HEAD method is identical to GET except that the server MUST NOT send a message body in the response (i.e., the response terminates at the end of the header section).‚Äù</p>
</blockquote>
<p>The <code>HEAD</code> method does not allow the browser to send more query parameters.</p>
<p><strong>Conclusion: not feasible</strong></p>
<h2 id="Solution-4-Use-POST-with-X-HTTP-Method-Override"><a href="#Solution-4-Use-POST-with-X-HTTP-Method-Override" class="headerlink" title="Solution 4: Use POST, with X-HTTP-Method-Override"></a>Solution 4: Use <code>POST</code>, with <code>X-HTTP-Method-Override</code></h2><p><a href="https://stackoverflow.com/a/43794292/1558430" target="_blank" rel="external">A StackOverflow answer</a> suggests sending the request as a <code>POST</code> (where the parameters are in the request body instead of the URI), with a <code>X-HTTP-Method-Override: GET</code> header, so the web server changes the request back to a <code>GET</code>. <a href="https://stackoverflow.com/a/19772029/1558430" target="_blank" rel="external">Google Translate does that with the text people type in to translate.</a></p>
<p>The twist: <a href="https://tools.ietf.org/html/rfc6648" target="_blank" rel="external"><code>X-HTTP-Method-Override</code> is deprecated</a>. The server also needs to manually sense that override, so it may well be a simple <code>POST</code> request.</p>
<p>While <a href="https://stackoverflow.com/a/14254114/1558430" target="_blank" rel="external">a lot of people have accepted the practice that a GET with too long or too complex a query string (e.g. query strings don‚Äôt handle nested data easily) can be sent as a POST instead</a>, many people have not. These people include those who review my code, and <a href="https://evertpot.com/dropbox-post-api/" target="_blank" rel="external">this blog</a>, who would rather <del>die</del> use <a href="https://tools.ietf.org/html/rfc8144#section-2.1" target="_blank" rel="external">a WebDAV verb called <code>REPORT</code></a> than <code>POST</code> (‚Äúits semantics are well defined and it works everywhere‚Äù).</p>
<p><strong>Conclusion: not feasible</strong> (at least from a code review perspective)</p>
<h2 id="Solution-5-Use-WebDAV‚Äôs-REPORT-method"><a href="#Solution-5-Use-WebDAV‚Äôs-REPORT-method" class="headerlink" title="Solution 5: Use WebDAV‚Äôs REPORT method"></a>Solution 5: Use WebDAV‚Äôs <code>REPORT</code> method</h2><p>Since <a href="https://evertpot.com/dropbox-post-api/" target="_blank" rel="external">this blog</a> really hated Dropbox changing from <code>GET</code> to <code>POST</code> for similar reasons (‚ÄúDon‚Äôt break the Web!‚Äù says the blog), sending query parameters as <code>POST</code>, and getting responses back, is right out. Django does not appear to support a <code>REPORT</code> verb, so that‚Äôs right out, too. (Even if it did, how much browser testing would you need to do to give you a required level of confidence?)</p>
<p><strong>Conclusion: not feasible</strong></p>
<p>But‚Ä¶ hold on, what did that blog post say?</p>
<h2 id="Solution-6-POST-the-query-but-GET-the-results"><a href="#Solution-6-POST-the-query-but-GET-the-results" class="headerlink" title="Solution 6: POST the query, but GET the results"></a>Solution 6: <code>POST</code> the query, but <code>GET</code> the results</h2><p>That post says (paraphrasing):</p>
<ol>
<li>Create a <code>site/reports/search</code> endpoint where you allow clients to submit <code>POST</code> requests, with request bodies containing <code>{filter1:&lt;filter1&gt;, filter2:&lt;filter2&gt;, ...}</code>.</li>
<li>This <code>POST</code> returns a URL (in the body) that tells you where to <code>GET</code> your results, e.g. <a href="https://tomharrisonjr.com/uuid-or-guid-as-primary-keys-be-careful-7b2aa3dcb439#bf0d" target="_blank" rel="external"><code>site/reports/search/88b413ec-fd2f-4269-983e-205eb2566c48</code></a>.</li>
<li>You <code>GET /site/reports/search/88b413ec-fd2f-4269-983e-205eb2566c48</code> to get your search results.</li>
</ol>
<p><a href="https://stackoverflow.com/a/31984477/1558430" target="_blank" rel="external">This StackOverflow answer</a> also suggests a similar <code>POST /site/reports/search</code> resource, whose sole purpose is to let users submit a search.</p>
<p>The reason this design works is twofold:</p>
<ol>
<li>The <code>POST</code> request is actually creating a resource, namely a search. (Consider <a href="https://stackoverflow.com/questions/14202257/design-restful-query-api-with-a-long-list-of-query-parameters#comment71350464_31984477" target="_blank" rel="external">returning a 200 instead of 201</a>, though.)</li>
<li>The <code>GET</code> URI is now short.</li>
<li>Bonus: <a href="https://evertpot.com/dropbox-post-api/" target="_blank" rel="external">‚ÄúThe results are still cacheable, safe and idempotent.‚Äù</a> (I‚Äôm not so sure about that)</li>
</ol>
<p>Of course, this comes with some complexity not required by a simple <code>GET</code> request. You need somewhere to save these searches. Like a database. If you save it to a database, then the search results may be stale. If you don‚Äôt save it to a database (like if you use Redis instead, for example), then you need to worry about users <code>GET</code>ting a <em>missing</em> search, which needs to return an HTTP 404 or 410.</p>
<p><strong>Conclusion: feasible, if you aren‚Äôt lazy</strong></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><ul>
<li>Use solution 4 if you are lazy, or</li>
<li>Use solution 6 if people review your code.</li>
</ul>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/Software-Development/">Software Development</a></li></ul>

			</span>
		</div>
	</footer>
	
</article>


	<hr class="article-devider">



  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="../../index.html">&laquo; Prev</a><a class="page-number" href="../../index.html">1</a><span class="page-number current">2</span><a class="page-number" href="../3/">3</a><a class="page-number" href="../4/">4</a><span class="space">&hellip;</span><a class="page-number" href="../23/">23</a><a class="extend next" rel="next" href="../3/">Next &raquo;</a>
    </nav>
  

    </div>
    <div class="mb-search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:blog.ohai.ca">
  </form>
</div>
<footer id="footer">
	<h1 class="footer-blog-title">
		<a href="/">root&#39;s Blog</a>
	</h1>
	<span class="copyright">
		&copy; 2019 root<br>
		Modify from <a href="http://sanographix.github.io/tumblr/apollo/" target="_blank">Apollo</a> theme, designed by <a href="http://www.sanographix.net/" target="_blank">SANOGRAPHIX.NET</a><br>
		Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
	</span>
</footer>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>



<script src="../../js/script.js"></script>
  </div>

  <script type="text/javascript">
    //<![CDATA[
    var sc_project=4446854;
    var sc_invisible=0;
    var sc_security="74785e80";
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write(
      "<sc"+"ript type='text/javascript' src='" +
      scJsHost +
      "statcounter.com/counter/counter_xhtml.js'></" +
      "script>"
    );
    //]]>
  </script>
  <noscript>
    <img style="display: none"
         src="http://c.statcounter.com/4446854/0/74785e80/0/" />
  </noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
